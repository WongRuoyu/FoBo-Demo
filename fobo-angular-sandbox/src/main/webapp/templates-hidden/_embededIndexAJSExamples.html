<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="content-type" />

<title>Embedded pretty template</title>
</head>

<!-- This is an embedded piece of html -->
<body class="lift:content_id=indexAJExamples">

   <section id='indexAJExamples'>

		<div class="row">
			<div class="col-sm-12">
				<a id="section-2"></a>
				<h2><span data-lift="Loc.i">Section 2</span></h2>

                <p>This section contains angular examples alongside with descriptions of the involved functions and code. 
                We start with a couple of fairly trivial examples that in the end will lead us to a excel like data grid example 
                with CRUD back-end data functionality that interact with the server using Lift 3.x round trip functions.</p>  
                <p>For overall setup and configuration of required resources see the <a href="#section-1" target="_self"><span data-lift="Loc.i">Section 1</span></a> 
                section. </p>              

				<div class="bs-callout bs-callout-info">
					<h4>
						<i class="fa fa-exclamation-triangle fa-2x"></i> New to AngularJS?
					</h4>
					<p>
						If you are new to AngularJS I <strong>strongly</strong> suggest
						that you, to get started with the basics, visit <a
							href="http://angularjs.org/">AngularJS</a> excellent home. There
						are plenty of examples, tutorials and other information that you
						will find valuable in you exciting endeavors into AngularJS land.
					</p>
				</div>

                <div class="col-sm-12"> 
                  <div class="embed-responsive embed-responsive-4by3">
                    <iframe class="embed-responsive-item" src="//www.youtube.com/embed/i9MHigUZKEM?feature=player_detailpage" frameborder="0" allowfullscreen></iframe>					
                  </div>
                </div>
                  

				<div class="row">
					<div class="col-sm-12">
						<a id="section-2-1"></a>
						<h3>Example 1:</h3>
				<p>
					If you are new to angular this example is for you, taken from the introduction on <a
						href="http://angularjs.org/">AngularJS home <i class="fa fa-external-link"></i></a>, 
						it will prepare you for the coming examples. If you are already familiar with Angular 
						you can skip this example and jump to the next where we throw our self right in to the 
						world Lift's server round trips.
				</p>						
						<p>This is a very simple angular only example (no server
							interaction) doing a ajax updates of the angular expression
							yourName.</p>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12">

						<div class="panel panel-default" style="padding: 10px;">
							<div class="row">
								<div class="col-sm-12">
									<div class="form-horizontal" role="form">
										<div class="form-group">
											<label for="name" class="col-sm-2 control-label">Name:</label>
											<div class="col-sm-10">
												<input id="name" class="form-control" type="text"
													ng-model="yourName" placeholder="Enter a name here">
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-10 col-sm-offset-2">
									<h4>Hello {{yourName}}!</h4>
								</div>
							</div>
						</div>

					</div>
				</div>

				<div class="row">
					<div class="col-sm-12 ">

						<p>The following shows the code involved in this example.</p>
						<span data-lift='embed?what=embeddedPretty/ex1-formWithNgModule'>
							Embedding the prettyprint ex1 form code here</span> 
						
						<p>This example we are creating a angular model 
						<a href="https://docs.angularjs.org/api/ng/directive/ngModel">ngModel <i class="fa fa-external-link"></i></a> 
						(<code>ng-model="yourName"</code>) with the assignable <a href="https://docs.angularjs.org/guide/expression">angular expression <i class="fa fa-external-link"></i></a> 
						<code>"yourName"</code>, we are then using this expression in a binding <code><span>{{</span> expression <span>}}</span></code> on the heading as shown below.</p>
							
						<span
							data-lift='embed?what=embeddedPretty/ex1-expressionBindingToHeding'> Embedding
							the prettyprint ex1 form code here</span>
						<p>As you type in a name the <code><span>{{</span>yourName<span>}}</span></code> value will get updated.</p> 	

					</div>
				</div>
				<hr>

				<div class="row">
					<div class="col-sm-12 ">
						<a id="section-2-2"></a>
						<h3>Example 2:</h3>
						<p>In this example we are doing a Lift 3 round trip to the server and back. 
						Still we are keeping the function simple to get you familiar with the concept.</p>
						 
						<p>When clicking on the "Simple RT" button the text above the button will be replaced with a text fetched 
						from the server. So what's happening is that the angular model gets updated via the angular controller 
						who is invoking a lift round trip function that, as part of its execution, invokes a Scala function on 
						the server, this function dose the calculations and returns it to the client.</p> 
						
						<p>The return value is put into Lift's <code>RoundTripHandlerFunc</code> who is then sending it back 
						from the server to the client, in this case it will end up as a future in the angular controller whereby 
						the angular module gets updated and the value will be displayed above the click button. </p>
						<p>In our case we are not handling errors but Lift's <code>RoundTripHandlerFunc</code> is not only able to send back data 
						but also signal end of data (for streams) or some error condition, you can read more about that in 
						<a href="http://blog.goodstuff.im/roundtrip_promises">DPP's Blog <i class="fa fa-external-link"></i></a></p>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default" style="padding: 10px;">
							<div class="row">
								<div class="col-sm-10 col-sm-offset-2">
									<div ng-controller="SimpleRTCtrl">
										<pre>{{lrtResModel}}</pre>
										<button type="button" class="btn btn-default"
											ng-click="doSimpleLiftRT()">Simple RT</button>
										<button type="button" class="btn btn-default"
											ng-click="doResetRT()">Reset</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12 ">
					    <br/>
					    <p>Below I will try explain the things involved in hooking up Lift roundtrip's with a angularJS 
					    <a href="https://docs.angularjs.org/guide/controller">controller <i class="fa fa-external-link"></i></a>, this <strong>"hookup" pattern</strong> is used in most of the following example(s).</p> 

				<div class="bs-callout bs-callout-warning">
					<h4>
						<i class="fa fa-exclamation-triangle fa-2x"></i> Modeling Lift Round Trips!
					</h4>
					    <p>As there are many ways to model the Lift round trips functionality you may see other blog post 
					    or turorilas doing thing's in a slightly different way, my hope is that you will see the overal "wiring" 
					    to be able to come up with something that sutes your needs.</p>
				</div>
				

					    
					    <p>Now let's start with a quote from David Pollak.</p>
					    
					    <blockquote class="pull-right">
					    <p>With Lift 3, we introduce the idea of Round Trips: a client-side request 
					    that's sent to the server where the client receives a Streaming Promise, 
					    the server performs its computations and when the results are ready, they 
					    get pushed to the clientâ€¦ and if there are multiple results, the multiple 
					    results are pushed to the client as the results become available.</p>
					    <small>David Pollak @dpp in <cite title="Source Title"><a href="http://blog.goodstuff.im/roundtrip_promises">Angular JS, Lift 3, and Streaming Promises</a></cite></small>
					    </blockquote>
					    <p>If you have not read David's <a href="http://blog.goodstuff.im/roundtrip_promises">blog post <i class="fa fa-external-link"></i></a> 
					    about Lift round trips, now is a good time to do it.</p>
					    
				        <div class="bs-callout bs-callout-info">
					        <h4>
						        <i class="fa fa-exclamation-triangle fa-2x"></i> Resource setup
					        </h4>
					        <p>
						    To avoid cluttering the examples with to much repeating details the overall 
						    resource setup has been ommited from the example section.
						    One way to setup angular, bootstrap and other front end toolkit resources in 
						    Lift is to use the FoBo module, you can read all about how to setup the 
						    resources used in this demo using FoBo in the 
						    <a href="#section-1" target="_self"><span data-lift="Loc.i">Section 1</span></a> section.       
					        </p>
				        </div>					    
					    					    
					    <p>Now lets look at the code. As this is the first example involving Lift roundtrip's and a bit more angular 
					    stuff I will show you all the essential parts, we start by look at this from the view (Lift html5 templates) 
					    focusing on the angular stuff.</p>
											    
					    <span
							data-lift='embed?what=embeddedPretty/ng-app-foboDemoApp'> Embedding
							the prettyprint ex2 code here</span>
						
						<p>The <a href="https://docs.angularjs.org/tutorial/step_00"><code>ng-app</code><i class="fa fa-external-link"></i></a> attribute represents an Angular directive named ngApp. 
						This directive is used to flag the html element that Angular should consider to be the 
						root element of the angular application. In our case the root element will be the 
						<code>div id=main</code> element.</p> 
						
					    <span
							data-lift='embed?what=embeddedPretty/ex2-assets-app'> Embedding
							the prettyprint ex2 code here</span>	
							
						<p>Here we are loading the <code>foboDemoApp</code> <a href="https://docs.angularjs.org/guide/module">module <i class="fa fa-external-link"></i></a> 
						with it's configuration and run blocks, althogh not nessary in this example we are also loading some module 
						dependancies <code>['ngGrid','ui.bootstrap']</code>, as the module dependencies is not used in this example 
					    we could have made it a empty list <code>[]</code>, we are however going to use the 
						dependancies in later examples.</p> 						
						
                        <span
							data-lift='embed?what=embeddedPretty/ex2-template-SimpleRTCtrl'> Embedding
							the prettyprint ex2 code here</span>
							
						<p>
						Above shows the controller declaration in the Lift template. Bellow is the javascript implementaion of the 
						same Angular <a href="https://docs.angularjs.org/guide/controller">controller <i class="fa fa-external-link"></i></a>
						</p>	
														
					    <span
							data-lift='embed?what=embeddedPretty/ex2-assets-controller-SimpleRTCtrl'> Embedding
							the prettyprint SimpleRTCtrl js code here</span>	
							
						<p>Now in the controller things are starting to get a bit more interesting, altogh we are keeping things simple. 
						Here we are calling, from the angular javascript controller, the round trip function <code>myRTFunctions.doSimpleRT();</code> 
						that is, a function that is hooked to native Lift/Scala code on the server. 
						This function will, if nothing unexpected happens, return a promise containing a json string fetched from 
						the server with the message <b>"There and back again!"</b></p>
						
						<p>I am going to show you the Lift server side code in a moment but let us first take a look at 
						the things that provides the glue between the server and the client starting with the snippet 
						declaration in the template.
						</p>	
							
                        <span data-lift='embed?what=embeddedPretty/ex2-data-lift-RoundTripInjector'> Embedding
							the data-lift Roundtrip injector </span>	
											    
					    <p>Above shows the <code>RoundTripBindingInjector</code> snippet that will inject the round trip hooks.</p> 
					    
					    <p>Below is the actual snippet implementation that renders the <i>hook up</i> functions as javascript code 
					    in the bottom of the html page. The <i>hook up</i> functions is added by calling the <code>getRoundTrips</code> 
					    function. In this example the function of interest is in the <code>SimpleRT</code> trait in later examples 
					    the functions is in the <code>PersonRT</code> trait. 
					    </p>
					    <span 
							data-lift='embed?what=embeddedPretty/ex2-code-snippet-RoundTripInjector'> Embedding
							the prettyprint roundtrip injector snippet code here</span>							
					    
					    <p>Below is the <code>SimpleRT</code> trait showing the mapping between 
					    the <code>doSimpleRT</code> js function and the Scala function, for simplicity and clearaty we also call that 
					    function <code>doSimpleRT</code>.
					     </p>
					    
					    <span
							data-lift='embed?what=embeddedPretty/ex2-code-snippet-SimpleRT'> Embedding
							the prettyprint ex2 code here</span>
						<p>As this is a very simple example we are only using the <code>send(/*some data*/)</code> 
						function. In addition using the <code>RoundTripHandlerFunc</code> we also have <code>done()</code> and 
						<code>failure(/*Some failure message*/)</code> that gives us explicit control over 
						sending data, done, and failure.</p>	
				
						<p>For completnes below is showing how we declare <code>getRoundTrips</code></p>
					    <span
							data-lift='embed?what=embeddedPretty/ex2-code-lib-PageRoundTrips'> Embedding
							the prettyprint ex2 code here</span>																			    
					    
					    <p>That's it! When you get your head around it, it ain't that complicated and as I said abowe this is one way
					    of doing it. Compaired with a simpler and more strait forward approach, using the <code>PageRoundTrips</code> 
					    abstraction (originally <a href="https://github.com/antidata/GoogleMaps">demonstrated <i class="fa fa-external-link"></i></a> 
					    by M. Lucchetta) above gives you some additional flexibilty as it in a decoupled way lets you organize your 
					    round trip functions into multiple snippet traits.</p>
					    
				<div class="bs-callout bs-callout-info">
					<h4>
						<i class="fa fa-exclamation-triangle fa-2x"></i> Styleguide
					</h4>
					<p>
					This demo group files in a <strong>functionally way</strong> (all templates/views together, all css together, 
					all js together etc...), this is, today, a common way of structuring web apps. New web technologies is however 
					emerging with <strong>web components</strong> as one of the most exiting and impacting ones, this will change 
					how we strukture future web apps and as technolgy merges this will include how we structure AngularJS and Lift 
					web apps too.</p>
					
					<p>With this in mind Google has put together some AngularJS style guide documentation, so if you want to get 
					up to date on how to structure future web apps the <strong>structurally way</strong> you can take a look at 
					this Angular blog post 
					<a href="http://blog.angularjs.org/2014/02/an-angularjs-style-guide-and-best.html">An AngularJS Style Guide and Best Practice for App Structure</a>	
					it contains references to these documents. 
					</p>
				</div>					    
					    
					    <br/>
						<p>Next in Example 3 we are going to use the same design pattern as outlined above but this time we 
						are going to fetch a array of data from the back-end store using slick and display it using the 
						Angular NG-Grid UI module provided by FoBo.</p>
					</div>
				</div>
				<hr>

				<div class="row">
					<div class="col-sm-12 ">
						<a id="section-2-3"></a>
						<h3>Example 3:</h3>
						<p>This example is doing a round trip to the server to fetch
							and display the grid data from the back-end store handled by
							slick. We are going to build on this example in the following
							examples to extend its functionality. Here we start with the
							simplest task of just fetching and displaying the data.</p>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default" style="padding: 10px;">
							<div class="row">
								<div class="col-sm-10 col-sm-offset-2">
									<div ng-controller="PersonGridCtrl">
										<div class="gridStyle" ng-grid="simpleGridOptions"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
               
               <span data-lift='embed?what=embeddedPretty/ex3-template-PersonCtrl'> Embedding
							the prettyprint ex3 code here</span>
							
				<p></p>		
					
                <span data-lift='embed?what=embeddedPretty/ex3-ng-controller'> Embedding
							the prettyprint ex3 code here</span>
							
                <span data-lift='embed?what=embeddedPretty/ex3-code-snippet-PersonRT'> Embedding
							the prettyprint ex2 code here</span>

				<hr>

				<div class="row">
					<div class="col-sm-12 ">
						<a id="section-2-4"></a>
						<h3>Example 4:</h3>
						<p>Building on Example 3 we are now adding the abillity to <b>add new Person</b> data to the back-end store and display 
						it in the grid by doing a roundtrip to the server to add the Person data and then return the new grid data from 
						the back-end store handled by slick.</p>
					</div>
				</div>


				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default" style="padding: 10px;">
							<div class="row">
								<div class="col-sm-10 col-sm-offset-2">
									<div ng-controller="PersonGridCtrl">
										<div class="gridStyle" ng-grid="simpleGridOptions"></div>
										<div class="form-inline" role="form">
											<div class="form-group">
												<input type="hidden" id="pid" ng-model="person.id">
												<label class="sr-only" for="pname">Name</label> 
												<input type="text" class="form-control" id="pname" placeholder="Enter name" ng-model="person.name">
											</div>
											<div class="form-group">
												<label class="sr-only" for="page">Age</label> 
												<input type="number" class="form-control" id="page" placeholder="Enter age" ng-model="person.age">
											</div>
											<button class="btn btn-default" ng-click='doAdd()'>Add</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

                <p>Below is the html scoped by the person grid controller. It has grown a bit compaired with 
                example 3 as we now add some, bootstrap styled, input fields and a button to submit the field vaules. 
                The interesting and new angular stuff, compaired to example 3, is the <code>ng-model</code> and the 
                <code>ng-click</code> bindings on input and button.</p>
                
                <span data-lift='embed?what=embeddedPretty/ex4-template-PersonCtrl'> Embedding
							the prettyprint ex3 code here</span>
							
                <span data-lift='embed?what=embeddedPretty/ex4-ng-controller'> Embedding
							the prettyprint ex3 code here</span>
														
                <span data-lift='embed?what=embeddedPretty/ex4-code-snippet-PersonRT'> Embedding
							the prettyprint ex2 code here</span>

				<hr>

				<div class="row">
					<div class="col-sm-12">
						<a id="section-2-5"></a>
						<h3>Example 5:</h3>
						<p>Building on example 4 we now also add <b>excel like cell edit</b> operations. 
						We also add a discrete <b>delete button</b> column for <b>entity delete</b> operations and
						as before we have the <b>add</b> function. </p>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default" style="padding: 10px;">
							<div class="row">
								<div class="col-sm-10 col-sm-offset-2">
									<div ng-controller="PersonGridCtrl">
										<div class="gridStyle" ng-grid="gridOptions"></div>
										<div class="form-inline" role="form">
											<div class="form-group">
												<input type="hidden" id="p2id" ng-model="person.id">
												<label class="sr-only" for="p2name">Name</label> 
												<input type="text" class="form-control" id="p2name" placeholder="Enter name" ng-model="person.name">
											</div>
											<div class="form-group">
												<label class="sr-only" for="p2age">Age</label> 
												<input type="number" class="form-control" id="p2age" placeholder="Enter age" ng-model="person.age">
											</div>
											<button class="btn btn-default" ng-click='doAdd()'>Add</button>											    
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<script type="text/ng-template" id="myModalTemplate.html"> 
                      <div class='modal-header'> 
                         <h4 class='modal-title'>Delete</h4> 
                       </div> 
                      <div class='modal-body'> 
                        <p><i class="fa fa-exclamation-triangle fa-3x" style="color:#f0ad4e;"></i> Are you sure you wish to delete person: {{ entity.name }} </p> 
                      </div> 
                      <div class='modal-footer'> 
                        <button class='btn btn-danger' ng-click='ok()'>OK</button> 
                        <button class='btn btn-default' ng-click='cancel()'>Cancel</button> 
                      </div>
                </script>
                
				<div class="bs-callout bs-callout-info">
					<h4>
						<i class="fa fa-exclamation-triangle fa-2x"></i> CRUD operations
					</h4>
					<p>
					To <b>edit</b> grid data, <b>double click</b> on a name or age cell, 
				    "end of edit" will trigger a <b>entity update</b>. 
				    <b>Add</b> and <b>delete</b> operations should be self-explaining.</p>
				</div>	
				
				<p>Below is the html for example 5 scoped by the person controller, the only difference from 
				example 4 is a change in grid options from <code>ng-grid="simpleGridOptions"</code> to 
				<code>ng-grid="gridOptions"</code></p>	
							
                <span data-lift='embed?what=embeddedPretty/ex5-template-PersonCtrl'> Embedding
							the prettyprint ex3 code here</span>	
										
				<p>Below is the final controller handling all CRUD operations on the ng-grid.</p>
				
               <span data-lift='embed?what=embeddedPretty/ex5-ng-controller'> Embedding
							the prettyprint ex3 code here</span>
									
				<p>Below is the final PersonRT trait handling all CRUD operations.</p>
														
                <span data-lift='embed?what=embeddedPretty/ex5-code-snippet-PersonRT'> Embedding
							the prettyprint ex2 code here</span>
											
				<p>This completes the example serie as we now have CRUD operations on the ng-grid.</p>			

			</div>
		</div>
 
		
    </section>
</body>